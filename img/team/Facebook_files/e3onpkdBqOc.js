/*!CK:3354059822!*//*1453756381,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["+y9Lp"]); }

__d('TimelineMapCalloutPager',['Arbiter','CSS','DOM','Event','KeyEventController','Keys','$'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();function o(){this.units=[];this.currentUnit=0;this.buttons=[];if(arguments.length>0)this.init.apply(this,arguments);}Object.assign(o.prototype,{_handleKeydown:function(event){var p=k.getKeyCode(event);if(p==m.LEFT){this.tabUnit(-1);}else if(p==m.RIGHT)this.tabUnit(1);},init:function(p,q,r,s,t){this.units=j.scry(n(p),s);this.currentUnit=parseInt(r,10);i.show(this.units[this.currentUnit]);if(t){t.subscribe('next',this.tabUnit.bind(this,1));t.subscribe('previous',this.tabUnit.bind(this,-1));}this.buttons=j.scry(q,'button');i.conditionClass(this.buttons[0],'uiButtonDisabled',this.currentUnit===0);i.conditionClass(this.buttons[1],'uiButtonDisabled',this.currentUnit===this.units.length-1);if(this.units.length<2)return;var u=this._handleKeydown.bind(this);l.registerKey('LEFT',u);l.registerKey('RIGHT',u);h.subscribe('PhotoSnowlift.CLOSE',function(){l.registerKey('LEFT',u);l.registerKey('RIGHT',u);});var v=h.subscribe(['PhotoSnowlift.OPEN','AggregatedMap/calloutHidden'],function(w,x){delete l.getInstance().handlers[m.LEFT];delete l.getInstance().handlers[m.RIGHT];if(w=='AggregatedMap/calloutHidden')v.unsubscribe();});},tabUnit:function(p){i.hide(this.units[this.currentUnit]);this.currentUnit=Math.max(Math.min(this.currentUnit+p,this.units.length-1),0);i.show(this.units[this.currentUnit]);i.conditionClass(this.buttons[0],'uiButtonDisabled',this.currentUnit===0);i.conditionClass(this.buttons[1],'uiButtonDisabled',this.currentUnit===this.units.length-1);}});f.exports=o;},null);
__d('OnlyMeUI',['AudienceSelectorTags','Arbiter','CSS','DOM','Parent','PrivacySelectorBase','PrivacyConst','SelectorDeprecated','$','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();function r(){return [k.create('div',{className:'onlyMeBorder'}),k.create('div',{className:'onlyMeBorder onlyMeBorderBottom'})];}function s(){return k.create('img',{alt:' ',className:'onlyMePrivacyCorner',height:34,src:'/images/profile/timeline/privacy_corner.png',width:34});}function t(aa){var ba=k.scry(aa,'.photoUnit a.photo');return ba.filter(function(ca){return !k.scry(ca,'.onlyMePrivacyCorner').length;});}function u(aa,ba){if(ba instanceof m){if(ba.getTags().length>1)return;}else if(h.hasTags(x(ba)))return;if(j.hasClass(aa,'storyContent'))if(!l.byClass(aa,'onlyMeWrap')){var ca=k.create('div',{className:'onlyMeWrap'});k.appendContent(l.byClass(aa,'uiStreamStory'),ca);k.appendContent(ca,aa);aa=ca;}else aa=l.byClass(aa,'onlyMeWrap');j.addClass(aa,'storyOnlyMe');if(!(ba instanceof m)&&!j.hasClass(aa,'timelineRecentActivityStory'))k.setContent(k.find(ba,'span.uiButtonText'),q._("Only Me"));if(!j.hasClass(aa,'storyContent')){var da=t(aa);for(var ea=0,fa=da.length;ea<fa;++ea)k.appendContent(da[ea],s());}if(!k.scry(aa,'div.onlyMeBorder').length){var ga=r();k.prependContent(aa,ga[0]);k.appendContent(aa,ga[1]);}}function v(aa){if(!aa)return;var ba=l.byClass(aa,'storyContent')||l.byClass(aa,'timelineRecentActivityStory')||l.byClass(aa,'timelineUnitContainer')||l.byClass(aa,'fbTimelineTwoColumn');if(!ba){ba=k.scry(aa,'^.permalink_stream .storyContent');ba=ba.length&&ba[0];}else if(j.hasClass(ba,'fbTimelineComposerUnit'))return null;return ba;}function w(aa){aa=j.hasClass(aa,'storyContent')?l.byClass(aa,'onlyMeWrap'):aa;aa&&j.removeClass(aa,'storyOnlyMe');}function x(aa){var ba=k.scry(aa,'*[data-oid]');if(ba.length===0)return '';return ba[0].getAttribute('data-oid');}var y=false,z={listenAdamaTimelineSelector:function(aa){var ba=aa.getInstance();ba.subscribe('changed',function(event,ca){var da=ba.getTriggerButtonElement(),ea=v(da);if(!ea)return;if(ca.post_param==n.PostParam.ONLY_ME){u(ea,ba);}else w(ea);});},init:function(){if(y)return;y=true;i.subscribe('AudienceSelector/changed',function(aa,ba){if(ba.selector&&j.hasClass(ba.selector,'blacklistOnlyMeUI'))return;var ca=v(ba.selector)||v(ba.clone);if(!ca)return;if(o.getOptionValue(ba.option)==n.BaseValue.SELF){u(ca,ba.selector);}else w(ca);});},_editOnlyMe:function(aa,ba){if(y)return;z.init();var ca=l.byClass(p(aa),'uiSelector');aa=ca&&k.find(ca,'a.uiSelectorButton');var da=v(aa);if(da){ba&&u(da,aa);!ba&&w(da);}},setOnlyMe:function(aa){this._editOnlyMe(aa,true);},removeOnlyMe:function(aa){this._editOnlyMe(aa,false);}};f.exports=z;},null);